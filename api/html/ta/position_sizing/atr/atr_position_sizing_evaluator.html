

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>atr_position_sizing_evaluator &mdash; ctxalgolib 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ctxalgolib 0.1 documentation" href="../../../index.html"/>
        <link rel="up" title="atr" href="index.html"/>
        <link rel="next" title="atr_position_sizing_trainer" href="atr_position_sizing_trainer.html"/>
        <link rel="prev" title="atr_position_sizer" href="atr_position_sizer.html"/> 

  
  <script src="../../../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../../index.html" class="icon icon-home"> ctxalgolib
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../loggers/index.html">loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../risk/index.html">risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pub_subs/index.html">pub_subs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rule_checking/index.html">rule_checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../news_analysis/index.html">news_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cache/index.html">cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../wind/index.html">wind</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../messaging/index.html">messaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trading_utils/index.html">trading_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../timer/index.html">timer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mt4/index.html">mt4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../backtesting/index.html">backtesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../machine_learning/index.html">machine_learning</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">ta</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../support_resistance/index.html">support_resistance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../signal_processing/index.html">signal_processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../correlation/index.html">correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chart_patterns/index.html">chart_patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../performance/index.html">performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../online_indicators/index.html">online_indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../piecewise_linear_regression/index.html">piecewise_linear_regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fibonacci/index.html">fibonacci</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../volume/index.html">volume</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">position_sizing</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">atr</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="atr_position_sizer.html">atr_position_sizer</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">atr_position_sizing_evaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="atr_position_sizing_trainer.html">atr_position_sizing_trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="atr_position_sizing_parameter_tuner.html">atr_position_sizing_parameter_tuner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stop_loss_trigger.html">stop_loss_trigger</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zhangdeyi/index.html">zhangdeyi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization/index.html">optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../forcast/index.html">forcast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lijin/index.html">lijin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_mining/index.html">data_mining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../strategies/index.html">strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../divergence/index.html">divergence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../harmonic/index.html">harmonic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pattern_recognizer/index.html">pattern_recognizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fractal/index.html">fractal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vsa/index.html">vsa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parameter_tuning/index.html">parameter_tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../volatility/index.html">volatility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lvt/index.html">lvt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trend/index.html">trend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../derivative/index.html">derivative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wavelet/index.html">wavelet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ta.html">ta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../turning_point_finder.html">turning_point_finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../thumb_line.html">thumb_line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cross.html">cross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../momentum.html">momentum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../indicator.html">indicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trading_direction.html">trading_direction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../triple_screen.html">triple_screen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../output/index.html">output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pydot/index.html">pydot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../slippage/index.html">slippage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trial/index.html">trial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ohlc/index.html">ohlc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../charting/index.html">charting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../report/index.html">report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_imports/index.html">data_imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trail/index.html">trail</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../http_trading/index.html">http_trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../time_series/index.html">time_series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../statistics/index.html">statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../eval/index.html">eval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mission_control/index.html">mission_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/index.html">scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utils.html">utils</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">ctxalgolib</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">ta</a> &raquo;</li>
      
          <li><a href="../index.html">position_sizing</a> &raquo;</li>
      
          <li><a href="index.html">atr</a> &raquo;</li>
      
    <li>atr_position_sizing_evaluator</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../sources/ta/position_sizing/atr/atr_position_sizing_evaluator.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="atr-position-sizing-evaluator">
<h1>atr_position_sizing_evaluator<a class="headerlink" href="#atr-position-sizing-evaluator" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-ctxalgolib.ta.position_sizing.atr.atr_position_sizing_evaluator"></span><dl class="class">
<dt id="ctxalgolib.ta.position_sizing.atr.atr_position_sizing_evaluator.AtrPositionSizingEvaluator">
<em class="property">class </em><code class="descclassname">ctxalgolib.ta.position_sizing.atr.atr_position_sizing_evaluator.</code><code class="descname">AtrPositionSizingEvaluator</code><span class="sig-paren">(</span><em>linear_regressor</em>, <em>atr_position_sizer1</em>, <em>atr_position_sizer2</em>, <em>last_sections=3</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgolib.ta.position_sizing.atr.atr_position_sizing_evaluator.AtrPositionSizingEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize current.
Parameters:</p>
<blockquote>
<div><dl class="docutils">
<dt>linear_regressor: PiecewiseLinearRegressor, the piecewise linear regressor which approximates</dt>
<dd>a OHLC time series into a set of connected line sections. From these line sections, we can get
up trends (line sections whose gradient is positive) and down trends (line sections whose
gradient are negative).</dd>
</dl>
<p>atr_position_sizer: AtrPositionSizer, the ATR position sizer which calculates ATR lines.
last_sections: int, the number of last up and down sections returned by the linear regressor, which</p>
<blockquote>
<div>are used for ATR position sizing evaluation. Only use the last sections means because it is
assumed that the last trends have more prediction power for the new future. -1 means start
from the first section.</div></blockquote>
</div></blockquote>
<dl class="method">
<dt id="ctxalgolib.ta.position_sizing.atr.atr_position_sizing_evaluator.AtrPositionSizingEvaluator.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>ohlc_list</em>, <em>trading_direction</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgolib.ta.position_sizing.atr.atr_position_sizing_evaluator.AtrPositionSizingEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate various results for ATR position sizer by calculating average_return_per_time_unit, winning_odds,
average_holding_days and winning_losing_ratio.
(1) average_return_per_time_unit.</p>
<blockquote>
<div>Take all up trends (or down trends if trading_direction is SHORT) calculated by linear_regressor,
for each up trend, assume that we always buy the stock at the starting point of the trend, and use
the ATR line calculated by atr_position_sizer as stop line. Use StopLossTrigger to find where the
close price crosses the stop line and use that price as sell price. if by the end of the trend, the stop
loss line is never touched by the close price, use the last close price in the trend as sell price.
The return of a trend in LONG trading is: (sell price - buy price * (1+tax)) / (buy_price*(1+tax)).
The return of a trend in SHORT trading is: -(sell price - buy_price * (1+tax)) / (buy_price*(1+tax)).
And the return per time unit is the return divided by the
number of trading days in a trend.
average_return_per_time_unit is average of all such per-time-unit returns.</div></blockquote>
<ol class="arabic simple" start="2">
<li>winning_odds
A winning transaction is a trading transaction with positive return. A losing transaction is one with
negative return.
winning_odds is calculated as: number of winning transaction / number of losing transaction.
If the number of losing transaction is 0, winning_odds = float(&#8220;inf&#8221;).</li>
<li>average_holding_days
For a trend, the holding days is the number of days between buy date and sell date.
average_holding_days is calculated as the average number among all up or down trends depending on
the given trading direction.</li>
<li>winning_losing_ratio
Calculated as:
average of winning returns / (- average of losing returns).
If average of losing returns is 0, winning_return_odds is set to float(&#8220;inf&#8221;).</li>
</ol>
<dl class="docutils">
<dt>Parameters:</dt>
<dd>ohlc: OHLC, OHLC data for a security.
trading_direction: TradingDirection, either LONG or SHORT.</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="atr_position_sizing_trainer.html" class="btn btn-neutral float-right" title="atr_position_sizing_trainer" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="atr_position_sizer.html" class="btn btn-neutral" title="atr_position_sizer" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, .
      Last updated on Nov 03, 2016.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../static/jquery.js"></script>
      <script type="text/javascript" src="../../../static/underscore.js"></script>
      <script type="text/javascript" src="../../../static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>